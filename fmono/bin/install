#!/usr/bin/env sh

set -e

#
# Installing Dive for examining container images
#
has_dive=`which dive | sed -e 's/^[[:space:]]*//'`
if [ -z "$has_dive" ]; then
  echo "[INFO] You do not have Dive installed. Installing now. \n"
  brew install dive
else
  echo "[SKIP] You already have Dive installed. Continuing. \n"
fi


#
# Installing NVM for various node versions
#
if [ -f ~/.nvm/nvm.sh ]; then
  echo '[INFO] You already have NVM installed. Sourcing. \n'
  . ~/.nvm/nvm.sh
else
  echo "[INFO] You do not have NVM installed. Installing now. \n"
  curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.38.0/install.sh | bash
fi


# Install node_modules for the api
echo "[INFO] Installing node_modules for api. \n" && \
  source ~/.nvm/nvm.sh && \
  nvm use && \
  npm install
